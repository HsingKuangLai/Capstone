Option Explicit

Sub readtable(companycode as String, yearcode as String)

Dim filename As String

filename = ThisWorkbook.Path & "\" & companycode & "_" & yearcode & "_gri.pdf"
 
Dim wApp As New Word.Application
Dim wDoc As Word.Document
Dim pg As Word.Paragraph
Dim FC As Boolean
Dim tbCount, tbIndex As Integer
Dim tRow As Long, tCol, lr As Long
Dim j, i As Integer
Dim str As String
Dim RegEx As Object, MyString As String
    Set RegEx = CreateObject("VBScript.RegExp")
    With RegEx
      .pattern = "\d{3}-\d{1,2}"
    End With

wApp.Visible = False

Set wDoc = wApp.Documents.Open(filename, False)

tbCount = wDoc.Tables.Count

'Cells(1, 1) = tbCount

If wDoc.Tables.Count > 0 Then

For tbIndex = 1 To tbCount

lr = Range("A" & Rows.Count).End(xlUp).Row

   With wDoc.Tables(tbIndex)
   
        For tRow = 1 To .Rows.Count
           
           lr = Range("A" & Rows.Count).End(xlUp).Row
           
        For tCol = 1 To .Columns.Count
           
              On Error Resume Next
              
              j = 1
              
              Do Until RegEx.Test(.cell(tRow, j).Range.Text) = True

                j = j + 1
                
                 
                If j > .Columns.Count Then
                      
                   j = 1
          
                   Exit For

                End If

              Loop
              
              If RegEx.Test(.cell(tRow, j).Range.Text) = True Then
              
              Cells(lr + 1, tCol).Value = .cell(tRow, tCol + j-1).Range.Text
              
              End If
              
             j = 1

              On Error GoTo 0
              
            Next tCol
            
         Next tRow
         
   End With

Next tbIndex

End If

wDoc.Close False
Set wDoc = Nothing

wApp.Quit
Set wApp = Nothing

End Sub



