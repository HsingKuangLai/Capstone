Sub ChangePage(pagedif As Integer)


Dim lr, i As Integer

Dim pattern As String

pattern = "\d+"

lr = Range("A" & Rows.Count).End(xlUp).Row

For i = 1 To lr
  
On Error Resume Next

 Cells(i, 3).Value = ExpandAndShift(Cells(i, 3).Value, pagedif)

 Next i

End Sub


Function ExpandAndShift(str As String, shiftVal As Integer) As String
    Dim regex As Object
    Dim matches As Object
    Dim match As Object
    Dim startVal As Long
    Dim endVal As Long
    Dim tempStr As String
    Dim outputStr As String
    
    Set regex = CreateObject("VBScript.RegExp")
    regex.pattern = "(\d+)-(\d+)|(\d+)"
    regex.Global = True
    Set matches = regex.Execute(str)
    
    For Each match In matches
        If match.SubMatches(0) <> "" Then
            startVal = CLng(match.SubMatches(0))
            endVal = CLng(match.SubMatches(1))
            
            For i = startVal To endVal
                tempStr = CStr(i + shiftVal)
                If outputStr = "" Then
                    outputStr = tempStr
                Else
                    outputStr = outputStr & "," & tempStr
                End If
            Next i
        Else
            tempStr = CStr(CLng(match.SubMatches(2)) + shiftVal)
            If outputStr = "" Then
                outputStr = tempStr
            Else
                outputStr = outputStr & "," & tempStr
            End If
        End If
    Next match
    
    ExpandAndShift = outputStr
End Function

